<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CYNOS | TITAN V2.5.0</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;700&family=JetBrains+Mono:wght@400;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #050505; --panel: #111111; --border: #333; --accent: #ff003c; 
            --text: #e0e0e0; --success: #00ff9d; --deep-work: #00d4ff;
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; user-select: none; }
        body { background: var(--bg); color: var(--text); font-family: 'JetBrains Mono', monospace; margin: 0; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        
        /* HUD & BARS */
        .hud { padding: 20px; background: var(--panel); border-bottom: 1px solid var(--border); z-index: 10; }
        .brand { display: flex; align-items: center; gap: 12px; margin-bottom: 15px; }
        .logo-img { width: 40px; height: 40px; border-radius: 50%; border: 2px solid var(--accent); cursor: pointer; }
        .xp-container { height: 4px; background: #222; margin: 10px 0; border-radius: 2px; }
        .xp-bar { height: 100%; background: var(--accent); width: 0%; transition: 0.5s; box-shadow: 0 0 10px var(--accent); }
        
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; }
        .stat-card { background: rgba(255,255,255,0.03); border: 1px solid var(--border); padding: 8px; border-radius: 6px; text-align: center; }
        .stat-val { font-size: 1rem; font-weight: 800; color: #fff; display: block; }
        .stat-label { font-size: 0.5rem; color: var(--accent); text-transform: uppercase; }

        /* BUFF INDICATORS */
        .buff-container { display: flex; gap: 5px; margin-top: 5px; }
        .buff-tag { font-size: 0.5rem; padding: 2px 5px; border-radius: 3px; background: var(--success); color: #000; font-weight: 900; animation: pulse 1s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }

        /* TABS */
        .tabs { display: flex; background: var(--bg); border-bottom: 1px solid var(--border); }
        .tab-btn { flex: 1; background: none; border: none; color: #555; padding: 15px; font-weight: 700; font-family: 'Space Grotesk'; cursor: pointer; }
        .tab-btn.active { color: var(--accent); border-bottom: 2px solid var(--accent); }

        /* CONTENT */
        .content { flex: 1; overflow-y: auto; padding: 20px; padding-bottom: 100px; }
        .input-group { display: flex; gap: 10px; margin-bottom: 20px; background: var(--panel); padding: 8px; border-radius: 10px; border: 1px solid var(--border); }
        .input-group input { background: transparent; border: none; color: #fff; flex: 1; font-family: 'JetBrains Mono'; }
        .input-group button { background: var(--accent); color: #fff; border: none; width: 40px; border-radius: 6px; font-weight: 900; }

        /* CARDS */
        .card { background: var(--panel); border-left: 3px solid var(--border); padding: 12px; border-radius: 4px; margin-bottom: 10px; display: flex; align-items: center; gap: 10px; position: relative; }
        .card.active-work { border-left-color: var(--deep-work); box-shadow: inset 0 0 10px rgba(0, 212, 255, 0.1); }
        .card.done { opacity: 0.4; border-left-color: var(--success); }
        
        .timer-display { font-size: 0.7rem; color: var(--deep-work); font-weight: 800; min-width: 45px; }
        .btn-work { background: #222; border: 1px solid var(--border); color: #fff; padding: 5px 10px; border-radius: 4px; font-size: 0.6rem; cursor: pointer; }
        .btn-work.running { background: var(--accent); border-color: var(--accent); }

        /* GACHA BOX */
        .gacha-box { background: linear-gradient(45deg, #1a1a1a, #222); border: 2px dashed var(--accent); padding: 20px; border-radius: 10px; text-align: center; margin-bottom: 20px; cursor: pointer; }
        .gacha-title { color: var(--accent); font-weight: 900; font-size: 1.2rem; margin-bottom: 5px; }
        
        /* MODAIS */
        #modal-reward { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 100; display: none; align-items: center; justify-content: center; text-align: center; }
        .reward-content { animation: scaleUp 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes scaleUp { from { transform: scale(0); } to { transform: scale(1); } }

        #toast { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: #fff; color: #000; padding: 10px 20px; border-radius: 20px; font-weight: 800; font-size: 0.7rem; z-index: 1000; display: none; }
    </style>
</head>
<body>

    <div id="modal-reward" onclick="this.style.display='none'">
        <div class="reward-content">
            <h1 id="reward-name" style="color: var(--accent); font-size: 3rem;"></h1>
            <p id="reward-desc" style="color: #fff;"></p>
            <small style="color: #666;">CLIQUE PARA COLETAR</small>
        </div>
    </div>

    <div id="toast"></div>

    <div class="hud">
        <div class="brand">
            <img src="https://i.ibb.co/mrn1JCLP/1000166598.png" class="logo-img" onclick="secretTrigger()">
            <div>
                <h1 style="margin:0; font-size: 1.2rem; letter-spacing: 1px;">CYNOS TITAN</h1>
                <div class="buff-container" id="active-buffs"></div>
            </div>
        </div>
        <div class="xp-container"><div class="xp-bar" id="xp-b"></div></div>
        <div class="stats-grid">
            <div class="stat-card"><span class="stat-val" id="c-val">0</span><span class="stat-label">Créditos</span></div>
            <div class="stat-card"><span class="stat-val" id="l-val">1</span><span class="stat-label">Nível</span></div>
            <div class="stat-card"><span class="stat-val" id="dw-val">0/4</span><span class="stat-label">Deep Focus</span></div>
        </div>
    </div>

    <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('missions', this)">OPERAÇÕES</button>
        <button class="tab-btn" onclick="switchTab('armory', this)">ARMORY</button>
        <button class="tab-btn" onclick="switchTab('logs', this)">SISTEMA</button>
    </div>

    <div class="content">
        <div id="view-missions">
            <div class="input-group">
                <input type="text" id="input-task" placeholder="Definir novo alvo...">
                <button onclick="addTask()">+</button>
            </div>
            <div id="list-missions"></div>
        </div>

        <div id="view-armory" style="display:none">
            <div id="list-armory"></div>
        </div>

        <div id="view-logs" style="display:none">
            <div id="gacha-area"></div>
            <div id="log-list" style="font-size: 0.6rem; color: #555;"></div>
        </div>
    </div>

<script>
    const AudioEngine = {
        ctx: null,
        init() { if(!this.ctx) this.ctx = new (window.AudioContext || window.webkitAudioContext)(); },
        play(freq, type='sine', dur=0.1) {
            this.init(); const osc = this.ctx.createOscillator(); const gain = this.ctx.createGain();
            osc.type = type; osc.frequency.setValueAtTime(freq, this.ctx.currentTime);
            gain.gain.setValueAtTime(0.1, this.ctx.currentTime);
            osc.connect(gain); gain.connect(this.ctx.destination);
            osc.start(); osc.stop(this.ctx.currentTime + dur);
        }
    };

    let db = JSON.parse(localStorage.getItem('cynos_v25')) || {
        lvl: 1, xp: 0, coins: 0, dwCount: 0, missions: [], logs: [], buffs: { x2xp: 0, x2money: 0 }, lastGacha: null
    };

    let activeTimers = {};

    function save() { 
        localStorage.setItem('cynos_v25', JSON.stringify(db)); 
        updateHUD(); 
    }

    function notify(msg) {
        const t = document.getElementById('toast');
        t.innerText = msg; t.style.display = 'block';
        setTimeout(() => t.style.display = 'none', 2000);
    }

    function updateHUD() {
        document.getElementById('l-val').innerText = db.lvl;
        document.getElementById('c-val').innerText = db.coins;
        document.getElementById('dw-val').innerText = `${db.dwCount}/4`;
        document.getElementById('xp-b').style.width = (db.xp / (db.lvl * 100) * 100) + '%';
        
        const buffsDiv = document.getElementById('active-buffs');
        buffsDiv.innerHTML = '';
        if(db.buffs.x2xp > Date.now()) buffsDiv.innerHTML += '<span class="buff-tag">2x XP</span>';
        if(db.buffs.x2money > Date.now()) buffsDiv.innerHTML += '<span class="buff-tag">2x $$$</span>';
    }

    function addTask() {
        const input = document.getElementById('input-task');
        if(!input.value) return;
        db.missions.unshift({ id: Date.now(), txt: input.value, done: false, time: 0, isDeep: false });
        input.value = ''; save(); renderMissions();
    }

    function toggleTimer(id) {
        AudioEngine.play(400);
        if(activeTimers[id]) {
            clearInterval(activeTimers[id]);
            delete activeTimers[id];
        } else {
            activeTimers[id] = setInterval(() => {
                const task = db.missions.find(m => m.id === id);
                if(task) {
                    task.time++;
                    if(task.time >= 900 && !task.isDeep) { // 15 minutos
                        task.isDeep = true;
                        AudioEngine.play(880, 'square', 0.5);
                        notify("STATUS: DEEP WORK ALCANÇADO!");
                    }
                    renderMissions();
                }
            }, 1000);
        }
        renderMissions();
    }

    function completeTask(id) {
        const task = db.missions.find(m => m.id === id);
        if(task.done) return;
        
        if(activeTimers[id]) { clearInterval(activeTimers[id]); delete activeTimers[id]; }

        let baseGain = task.isDeep ? 50 : 5;
        let xpGain = db.buffs.x2xp > Date.now() ? baseGain * 2 : baseGain;
        let coinGain = db.buffs.x2money > Date.now() ? baseGain * 2 : baseGain;

        db.xp += xpGain;
        db.coins += coinGain;
        if(task.isDeep) db.dwCount++;
        
        task.done = true;
        AudioEngine.play(600, 'sine', 0.3);
        
        if(db.xp >= db.lvl * 100) { db.lvl++; db.xp = 0; AudioEngine.play(1000, 'square', 0.5); }
        
        save(); renderMissions();
    }

    function renderMissions() {
        const list = document.getElementById('list-missions');
        list.innerHTML = '';
        db.missions.forEach(m => {
            const min = Math.floor(m.time / 60);
            const sec = m.time % 60;
            const timeStr = `${min}:${sec.toString().padStart(2, '0')}`;
            
            const card = document.createElement('div');
            card.className = `card ${activeTimers[m.id] ? 'active-work' : ''} ${m.done ? 'done' : ''}`;
            card.innerHTML = `
                <div style="flex:1">
                    <div style="font-size:0.9rem; font-weight:700">${m.txt}</div>
                    <div class="timer-display">${timeStr} ${m.isDeep ? '⚡' : ''}</div>
                </div>
                ${!m.done ? `
                    <button class="btn-work ${activeTimers[m.id] ? 'running' : ''}" onclick="toggleTimer(${m.id})">
                        ${activeTimers[m.id] ? 'PAUSE' : 'FOCUS'}
                    </button>
                    <button class="btn-work" style="background:var(--success); color:#000" onclick="completeTask(${m.id})">DONE</button>
                ` : `<span style="color:var(--success); font-weight:900">CHECK</span>`}
            `;
            list.appendChild(card);
        });
    }

    // GACHA LOGIC
    function checkGacha() {
        const area = document.getElementById('gacha-area');
        const today = new Date().toDateString();
        
        if(db.lastGacha !== today && db.dwCount >= 4) {
            area.innerHTML = `
                <div class="gacha-box" onclick="openGacha()">
                    <div class="gacha-title">BAÚ DE PERFORMANCE</div>
                    <small>RECOMPENSA DE MEIA-NOITE DISPONÍVEL</small>
                </div>
            `;
        } else if (db.dwCount < 4) {
            area.innerHTML = `<div style="text-align:center; padding:10px; color:#444; font-size:0.7rem">COMPLETE 4 MISSÕES DE FOCO PARA LIBERAR O BAÚ</div>`;
        } else {
            area.innerHTML = `<div style="text-align:center; padding:10px; color:var(--success); font-size:0.7rem">BAÚ COLETADO HOJE. PRÓXIMO À MEIA-NOITE.</div>`;
        }
    }

    function openGacha() {
        const rewards = [
            { name: "Soro de Foco", desc: "Dobro de Créditos por 30 min", type: "money", val: 30 },
            { name: "Micro-Dose XP", desc: "Dobro de XP por 15 min", type: "xp", val: 15 },
            { name: "Estoque de Ouro", desc: "Ganhou 200 Créditos Instantâneos", type: "instant", val: 200 }
        ];
        
        const res = rewards[Math.floor(Math.random() * rewards.length)];
        db.lastGacha = new Date().toDateString();
        
        if(res.type === 'money') db.buffs.x2money = Date.now() + (res.val * 60000);
        if(res.type === 'xp') db.buffs.x2xp = Date.now() + (res.val * 60000);
        if(res.type === 'instant') db.coins += res.val;

        document.getElementById('reward-name').innerText = res.name;
        document.getElementById('reward-desc').innerText = res.desc;
        document.getElementById('modal-reward').style.display = 'flex';
        
        db.dwCount = 0; // Reinicia para o novo dia
        save(); checkGacha();
    }

    function switchTab(t, b) {
        document.getElementById('view-missions').style.display = t==='missions'?'block':'none';
        document.getElementById('view-armory').style.display = t==='armory'?'block':'none';
        document.getElementById('view-logs').style.display = t==='logs'?'block':'none';
        document.querySelectorAll('.tab-btn').forEach(x=>x.classList.remove('active')); b.classList.add('active');
        if(t==='logs') checkGacha();
    }

    // START
    save(); renderMissions();
    document.body.addEventListener('click', () => AudioEngine.init(), {once:true});
</script>
</body>
</html>
